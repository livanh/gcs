#!/bin/sh

# TODO: handle profiles
# TODO: set color palette

terminator_set_value_default_profile() {
    
    local key="$1"
    local value="$2"
    local file="$3"
    
    sed -i "
    /\[profiles\]/{
    N
        /\[\[default\]\]/{
        : loop
        N
        s/${key}\ =.*/${key} = \"${value}\"/
        t endloop
        /\[\[default\]\].*\[\[/{
            s/\[\[default\]\]/\[\[default\]\]\n    ${key} = \"${value}\"/
            b endloop
        }
        b loop
        : endloop
        }

    }

    " "${file}"
    
} 

TERMINATOR_CONFIG_FILE="$HOME/.config/terminator/config"
if [ -f "${TERMINATOR_CONFIG_FILE}" ]; then
    printf "* Setting colors for terminator..."
    terminator_set_value_default_profile "background_color" "${terminal_bg_color}"  "${TERMINATOR_CONFIG_FILE}"
    terminator_set_value_default_profile "foreground_color" "${terminal_fg_color}"  "${TERMINATOR_CONFIG_FILE}"
    terminator_set_value_default_profile "cursor_color"     "${terminal_bg_color}"  "${TERMINATOR_CONFIG_FILE}"
    terminator_palette="${terminal_palette_black}:${terminal_palette_red}:${terminal_palette_green}:${terminal_palette_yellow}:${terminal_palette_blue}:${terminal_palette_purple}:${terminal_palette_cyan}:${terminal_palette_white}:${terminal_palette_light_black}:${terminal_palette_light_red}:${terminal_palette_light_green}:${terminal_palette_light_yellow}:${terminal_palette_light_blue}:${terminal_palette_light_purple}:${terminal_palette_light_cyan}:${terminal_palette_light_white}"
    terminator_set_value_default_profile "palette"          "${terminator_palette}" "${TERMINATOR_CONFIG_FILE}"
    printf " done.\n"
fi
